'use strict';
var childProcess = require('child_process');
var path = require('path');
var objectAssign = require('object-assign');
var Promise = require('bluebird');
var debug = require('debug')('ava');
var send = require('./send');

module.exports = function (file, opts) {
	var filepath = path.join(__dirname, 'babel.js');
	opts = objectAssign({file: file}, opts);

	var options = {
		cwd: path.dirname(file),
		stdio: ['ignore', process.stderr, process.stderr]
	};

	var args = [JSON.stringify(opts)];

	var 